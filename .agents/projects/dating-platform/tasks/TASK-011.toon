task:
 id: TASK-011
 project: dating-platform
 title: Build AI relationship coaching system (Premium feature)
 type: backend
 priority: 5
 status: blocked

description:
 summary: Create GPT-4 powered relationship coaching for Elite tier subscribers
 details: |
  Implement coaching features:
  - Conversation analysis and feedback
  - Personalized communication tips
  - Attachment-aware coaching strategies
  - GPT-4 generated insights based on message history
  - Weekly coaching summaries
  - Progress tracking over time
  - Privacy-preserving: Only analyze user's own messages
  - Clear AI labeling on all coaching content
  - Opt-in required (separate from practice companions)

acceptance_criteria[10]:
 GET /api/coaching/insights returns personalized tips
 Coaching analyzes user's message patterns
 Attachment style considered in coaching advice
 GPT-4 generates contextual communication suggestions
 Weekly summary email with coaching insights
 Progress metrics tracked (response rate, conversation length)
 Only available for Elite tier subscribers
 All coaching content labeled with ðŸ¤–
 Users opt-in separately to coaching features
 Privacy policy updated to reflect message analysis

dependencies:
 required[3]:
  TASK-009
  TASK-010
  TASK-013
 blocks[0]:

context:
 files_to_create[7]:
  backend/services/ai/coaching.py
  backend/services/ai/analysis.py
  backend/services/ai/insights.py
  backend/services/ai/progress.py
  backend/services/ai/tests/test_coaching.py
  backend/services/ai/prompts/coaching_prompts.py
  backend/workers/weekly_coaching_summary.py

technical_details:
 stack[4]:
  FastAPI 0.104+
  OpenAI Python SDK 1.3+
  Celery for weekly summaries
  SQLAlchemy 2.0
 endpoints[4]:
  GET /api/coaching/insights
  GET /api/coaching/progress
  POST /api/coaching/opt-in
  GET /api/coaching/weekly-summary
 analysis_dimensions[6]:
  message_frequency
  response_time
  conversation_depth
  emotional_tone
  question_asking_rate
  reciprocity_balance

coaching_strategies:
 secure_style: Reinforce healthy patterns, celebrate wins
 anxious_style: Reduce over-messaging, practice patience
 avoidant_style: Encourage vulnerability, deeper sharing
 fearful_style: Balance openness with healthy boundaries

metadata:
 created_by: architect-agent
 created_at: 2025-11-17T17:08:00Z
 estimated_hours: 14
 complexity: high
